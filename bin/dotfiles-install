#!/usr/bin/env python
# vim: et sw=4 ts=4:

import os
import sys

def relink(target, linkname):
    target = os.path.expanduser(target)
    linkname = os.path.expanduser(linkname)
    if os.path.exists(linkname):
        if os.path.islink(linkname):
            os.unlink(linkname)
        else:
            raise Exception('%s is not a symlink' % linkname)
    os.symlink(target, linkname)

def mkdir(p):
    try:
        os.mkdir(os.path.expanduser(p))
    except:
        pass

def main():
    mkdir('~/.fonts')
    mkdir('~/.fonts/adobe-fonts')
    relink('~/.dotfiles/lib/source-code-pro', '~/.fonts/adobe-fonts/source-code-pro')
    os.system('fc-cache -f -v ~/.fonts/adobe-fonts/source-code-pro')

    relink('.dotfiles/git/gitconfig', '~/.gitconfig')

    relink('.dotfiles/i3', '~/.i3')

    relink('.dotfiles/iftop/iftoprc', '~/.iftoprc')

    relink('.dotfiles/lib/spacemacs', '~/.emacs.d')
    relink('.dotfiles/spacemacs/spacemacs', '~/.spacemacs')

    relink('~/.dotfiles/ssh/config', '~/.ssh/config')

    relink('.dotfiles/sshrc', '~/.sshrc.d')
    relink('.dotfiles/sshrc/sshrc', '~/.sshrc')

    relink('.dotfiles/tmux/tmux.conf', '~/.tmux.conf')

    relink('.dotfiles/vim/vimrc', '~/.vimrc')

    relink('.dotfiles/zsh/zshrc', '~/.zshrc')

    relink('~/.dotfiles/lib/pyenv-virtualenv',
           '~/.dotfiles/lib/pyenv/plugins/pyenv-virtualenv')

if __name__ == '__main__':
    sys.exit(main())

